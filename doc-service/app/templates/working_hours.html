<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ title }}</title>
  <style>
    :root {
      --brand-primary: {{ brand_primary | default('#1e293b') }};
      --brand-secondary: {{ brand_secondary | default('#334155') }};
      --brand-accent: {{ brand_accent | default('#3b82f6') }};
      --brand-neutral: {{ brand_neutral | default('#f8fafc') }};
    }
    @page {
      size: A4 landscape;
      margin: 1.5cm;
      @bottom-center { content: "Page " counter(page) " of " counter(pages); font-size: 8px; color: #888; }
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #1a1a1a; font-size: 10px; line-height: 1.4; }

    .header { background: var(--brand-primary); color: #fff; padding: 16px 24px; margin: -1.5cm -1.5cm 0 -1.5cm; }
    .header h1 { font-size: 18px; font-weight: 700; margin-bottom: 2px; }
    .header .subtitle { font-size: 11px; opacity: 0.85; }
    .header-logo { max-height: 36px; max-width: 140px; margin-bottom: 6px; }
    .accent-divider { height: 3px; background: var(--brand-accent); margin: 0 -1.5cm 16px -1.5cm; }

    .event-info { display: flex; justify-content: space-between; margin-bottom: 14px; padding: 10px 14px; background: var(--brand-neutral); border-radius: 6px; border: 1px solid #e2e8f0; }
    .event-info .info-block { }
    .info-label { font-size: 8px; text-transform: uppercase; letter-spacing: 0.5px; color: #64748b; margin-bottom: 1px; }
    .info-value { font-size: 12px; font-weight: 600; color: var(--brand-primary); }

    table { width: 100%; border-collapse: collapse; margin-bottom: 16px; }
    th { background: var(--brand-primary); color: #fff; font-size: 8.5px; text-transform: uppercase; letter-spacing: 0.4px; padding: 7px 6px; text-align: left; }
    th.center { text-align: center; }
    td { padding: 10px 6px; border-bottom: 1px solid #cbd5e1; font-size: 9.5px; vertical-align: middle; }
    tr:nth-child(even) { background: var(--brand-neutral); }
    td.center { text-align: center; }

    .signature-cell { min-width: 80px; border-bottom: 1px dotted #94a3b8; }
    .break-cell { min-width: 50px; }

    .totals-row td { font-weight: 700; background: #f1f5f9; border-top: 2px solid var(--brand-primary); }

    .sign-off { margin-top: 24px; display: flex; justify-content: space-between; gap: 40px; }
    .sign-off-block { flex: 1; }
    .sign-off-label { font-size: 9px; color: #64748b; margin-bottom: 20px; }
    .sign-off-line { border-bottom: 1px solid var(--brand-secondary); margin-bottom: 4px; height: 20px; }
    .sign-off-hint { font-size: 8px; color: #94a3b8; }

    .footer { margin-top: 20px; padding-top: 8px; border-top: 1px solid #e2e8f0; font-size: 8px; color: #94a3b8; text-align: center; }

    .badge { display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 8px; font-weight: 600; }
    .badge-clocked { background: #dcfce7; color: #166534; }
    .badge-pending { background: #fef3c7; color: #92400e; }
    .badge-none { background: #f1f5f9; color: #64748b; }

    {% if template_design == 'plain' %}
    .header { background: #ffffff; color: #1a1a1a; border-bottom: 1px solid #e2e8f0; }
    .header h1 { color: #1a1a1a; }
    .header .subtitle { color: #64748b; opacity: 1; }
    .accent-divider { display: none; }
    th { background: #f9fafb; color: #374151; border-bottom: 2px solid #d1d5db; }
    tr:nth-child(even) { background: transparent; }
    td { border-bottom: 1px solid #e5e7eb; }
    .event-info { background: #f9fafb; border-color: #e5e7eb; }
    .info-value { color: #374151; }
    .totals-row td { border-top: 2px solid #9ca3af; }
    .header-logo { display: none; }
    {% endif %}

    {% if template_design == 'executive' %}
    .header { background: #ffffff; color: #1a1a1a; padding-bottom: 12px; border-top: 4px solid var(--brand-accent); }
    .header h1 { color: var(--brand-primary); }
    .header .subtitle { color: #64748b; opacity: 1; }
    .accent-divider { display: none; }
    th { background: #f8fafc; color: var(--brand-primary); }
    tr:nth-child(even) { background: #fafbfc; }
    .event-info { background: #ffffff; border-left: 3px solid var(--brand-accent); border-radius: 0 6px 6px 0; }
    .info-value { color: var(--brand-primary); }
    .totals-row td { border-top: 2px solid var(--brand-primary); }
    {% endif %}
  </style>
</head>
<body>
  {% if template_design == 'executive' and logo_header_url %}
  <div class="header">
    <div style="display:flex;align-items:center;gap:16px;">
      <img class="header-logo" src="{{ logo_header_url }}" alt="Logo">
      <div>
        <h1>{{ title }}</h1>
        <div class="subtitle">{{ company_name }} &mdash; Working Hours Sheet</div>
      </div>
    </div>
  </div>
  {% else %}
  <div class="header">
    {% if logo_header_url %}<img class="header-logo" src="{{ logo_header_url }}" alt="Logo">{% endif %}
    <h1>{{ title }}</h1>
    <div class="subtitle">{{ company_name }} &mdash; Working Hours Sheet</div>
  </div>
  {% endif %}
  <div class="accent-divider"></div>

  <div class="event-info">
    <div class="info-block">
      <div class="info-label">Client</div>
      <div class="info-value">{{ event_client }}</div>
    </div>
    <div class="info-block">
      <div class="info-label">Event / Shift</div>
      <div class="info-value">{{ event_name }}</div>
    </div>
    <div class="info-block">
      <div class="info-label">Date</div>
      <div class="info-value">{{ event_date }}</div>
    </div>
    <div class="info-block">
      <div class="info-label">Scheduled</div>
      <div class="info-value">{{ event_start }} &ndash; {{ event_end }}</div>
    </div>
    <div class="info-block">
      <div class="info-label">Venue</div>
      <div class="info-value">{{ event_venue }}</div>
    </div>
    <div class="info-block">
      <div class="info-label">Staff Count</div>
      <div class="info-value">{{ staff_count }}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width: 3%;">#</th>
        <th style="width: 15%;">Staff Name</th>
        <th style="width: 9%;">Role</th>
        <th style="width: 9%;">Phone</th>
        <th style="width: 8%;">Company ID</th>
        <th class="center" style="width: 8%;">Sched. In</th>
        <th class="center" style="width: 8%;">Sched. Out</th>
        <th class="center" style="width: 8%;">Clock In</th>
        <th class="center" style="width: 8%;">Clock Out</th>
        <th class="center" style="width: 6%;">Break</th>
        <th class="center" style="width: 7%;">Total Hrs</th>
        <th style="width: 11%;">Signature</th>
      </tr>
    </thead>
    <tbody>
      {% for row in rows %}
      <tr>
        <td>{{ loop.index }}</td>
        <td><strong>{{ row.name }}</strong></td>
        <td>{{ row.role }}</td>
        <td>{{ row.phone }}</td>
        <td>{{ row.companyId }}</td>
        <td class="center">{{ row.scheduledIn }}</td>
        <td class="center">{{ row.scheduledOut }}</td>
        <td class="center">{{ row.clockIn }}</td>
        <td class="center">{{ row.clockOut }}</td>
        <td class="center break-cell">{{ row.breakDuration }}</td>
        <td class="center"><strong>{{ row.totalHours }}</strong></td>
        <td class="signature-cell"></td>
      </tr>
      {% endfor %}
      {% if totals %}
      <tr class="totals-row">
        <td colspan="10" style="text-align: right;">TOTAL</td>
        <td class="center">{{ totals.totalHours }}</td>
        <td></td>
      </tr>
      {% endif %}
    </tbody>
  </table>

  {% if notes %}
  <div style="margin-bottom: 16px; padding: 8px 12px; background: #fffbeb; border: 1px solid #fde68a; border-radius: 4px; font-size: 9px;">
    <strong>Notes:</strong> {{ notes }}
  </div>
  {% endif %}

  <div class="sign-off">
    <div class="sign-off-block">
      <div class="sign-off-label">Manager Signature</div>
      <div class="sign-off-line"></div>
      <div class="sign-off-hint">Name / Date</div>
    </div>
    <div class="sign-off-block">
      <div class="sign-off-label">Client Representative</div>
      <div class="sign-off-line"></div>
      <div class="sign-off-hint">Name / Date</div>
    </div>
  </div>

  <div class="footer">
    Generated by {{ company_name }} &mdash; {{ generated_at }}
  </div>
</body>
</html>
