<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ title }}</title>
  <style>
    :root {
      --brand-primary: {{ brand_primary | default('#1e293b') }};
      --brand-secondary: {{ brand_secondary | default('#334155') }};
      --brand-accent: {{ brand_accent | default('#3b82f6') }};
    }
    @page {
      size: A4;
      margin: 2cm;
      @bottom-center { content: "Page " counter(page) " of " counter(pages); font-size: 8px; color: #b0b0b0; }
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #1a1a1a; font-size: 11px; line-height: 1.5; }

    /* ── CLASSIC (default) ─────────────────────────────────────────────── */
    /* White header, logo stacked above title, brand accent as thin line  */
    .header { background: #ffffff; color: #1a1a1a; padding: 20px 0 16px 0; }
    .header h1 { font-size: 20px; font-weight: 700; color: var(--brand-primary); letter-spacing: -0.3px; }
    .header .subtitle { font-size: 11px; color: #6b7280; margin-top: 2px; }
    .header-logo { max-height: 100px; max-width: 280px; margin-bottom: 14px; display: block; }
    .accent-divider { height: 1.5px; background: var(--brand-accent); margin: 0 0 20px 0; }

    .meta { display: flex; justify-content: space-between; margin-bottom: 20px; padding: 14px 18px; background: #fafafa; border-radius: 6px; border: 0.5px solid #e5e7eb; }
    .meta-item { text-align: center; }
    .meta-label { font-size: 8px; text-transform: uppercase; letter-spacing: 0.6px; color: #9ca3af; font-weight: 500; }
    .meta-value { font-size: 15px; font-weight: 700; color: #1a1a1a; }

    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th { background: #fafafa; color: #4b5563; font-size: 9px; text-transform: uppercase; letter-spacing: 0.5px; padding: 8px 10px; text-align: left; border-bottom: 0.5px solid #d1d5db; font-weight: 600; }
    td { padding: 7px 10px; border-bottom: 0.3px solid #e5e7eb; font-size: 10.5px; color: #374151; }
    tr:nth-child(even) { background: #fafbfc; }
    .summary-row td { font-weight: 700; background: #f5f5f5; border-top: 0.5px solid #d1d5db; color: #1a1a1a; }
    .text-right { text-align: right; }
    .footer { margin-top: 30px; padding-top: 10px; border-top: 0.3px solid #e5e7eb; font-size: 8px; color: #b0b0b0; text-align: center; }

    {% if template_design == 'plain' %}
    /* ── PLAIN ─ Minimal, no branding, no color, just clean structure ── */
    .header { border-bottom: 0.3px solid #d1d5db; padding-bottom: 12px; }
    .header h1 { color: #000000; font-weight: 600; }
    .header .subtitle { color: #6b7280; }
    .header-logo { display: none; }
    .accent-divider { display: none; }
    th { background: #ffffff; color: #4b5563; border-bottom: 0.5px solid #d1d5db; }
    tr:nth-child(even) { background: transparent; }
    td { border-bottom: 0.3px solid #e5e7eb; }
    .meta { background: #ffffff; border-color: #e5e7eb; }
    .meta-value { color: #000000; }
    .summary-row td { background: #f9fafb; border-top: 0.5px solid #9ca3af; }
    {% endif %}

    {% if template_design == 'executive' %}
    /* ── EXECUTIVE ─ Refined, generous whitespace, accent top border ─── */
    .header { padding: 24px 0 18px 0; border-top: 2.5px solid var(--brand-accent); }
    .header h1 { font-size: 22px; font-weight: 600; color: var(--brand-primary); letter-spacing: -0.5px; }
    .header .subtitle { font-size: 10.5px; color: #9ca3af; letter-spacing: 0.3px; }
    .accent-divider { display: none; }
    th { background: #ffffff; color: var(--brand-primary); font-weight: 600; border-bottom: 0.5px solid #e5e7eb; }
    tr:nth-child(even) { background: #fcfcfd; }
    .meta { background: #ffffff; border: 0.5px solid #e5e7eb; border-left: 2.5px solid var(--brand-accent); border-radius: 0 6px 6px 0; }
    .meta-value { color: var(--brand-primary); }
    .summary-row td { background: #fafbfc; border-top: 0.5px solid var(--brand-accent); }
    {% endif %}

    {% if template_design == 'modern' %}
    /* ── MODERN ─ Contemporary, rounded cards, subtle shadows, warm grey */
    .header { padding: 28px 0 20px 0; }
    .header h1 { font-size: 21px; font-weight: 700; color: #000000; }
    .header .subtitle { font-size: 10.5px; color: #9ca3af; font-weight: 400; }
    .accent-divider { height: 0; margin: 0; display: none; }
    .header-logo { margin-bottom: 16px; }

    .meta { background: #f7f7f8; border: none; border-radius: 10px; padding: 16px 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.04); margin-bottom: 24px; }
    .meta-label { color: #9ca3af; font-size: 7.5px; letter-spacing: 0.8px; }
    .meta-value { color: #000000; font-size: 14px; font-weight: 700; }

    table { border-spacing: 0; }
    th { background: transparent; color: #9ca3af; font-size: 8.5px; text-transform: uppercase; letter-spacing: 0.6px; padding: 10px 10px 6px 10px; border-bottom: 0.5px solid #e5e7eb; font-weight: 500; }
    td { padding: 9px 10px; border-bottom: 0.3px solid #f0f0f0; font-size: 10.5px; color: #1a1a1a; }
    tr:nth-child(even) { background: #fafafb; }
    .summary-row td { font-weight: 700; background: transparent; border-top: 0.5px solid #d1d5db; color: #000000; padding-top: 12px; }
    .footer { border-top: none; color: #c0c0c0; margin-top: 36px; }
    {% endif %}
  </style>
</head>
<body>
  <div class="header">
    {% if logo_header_url %}<img class="header-logo" src="{{ logo_header_url }}" alt="Logo">{% endif %}
    <h1>{{ title }}</h1>
    <div class="subtitle">{{ company_name }} &mdash; {{ period_label }}</div>
  </div>
  <div class="accent-divider"></div>

  <div class="meta">
    {% for item in summary_items %}
    <div class="meta-item">
      <div class="meta-label">{{ item.label }}</div>
      <div class="meta-value">{{ item.value }}</div>
    </div>
    {% endfor %}
  </div>

  <table>
    <thead>
      <tr>
        {% for col in columns %}
        <th{% if col.align == 'right' %} class="text-right"{% endif %}>{{ col.label }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for row in rows %}
      <tr>
        {% for col in columns %}
        <td{% if col.align == 'right' %} class="text-right"{% endif %}>{{ row[col.key] }}</td>
        {% endfor %}
      </tr>
      {% endfor %}
      {% if totals %}
      <tr class="summary-row">
        {% for col in columns %}
        <td{% if col.align == 'right' %} class="text-right"{% endif %}>{{ totals.get(col.key, '') }}</td>
        {% endfor %}
      </tr>
      {% endif %}
    </tbody>
  </table>

  <div class="footer">
    Generated by {{ company_name }} Document Service &mdash; {{ generated_at }}
  </div>
</body>
</html>
